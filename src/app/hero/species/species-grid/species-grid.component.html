<div class="species-grid">
  <!-- Loading state -->
  @if (isLoading()) {
    <div class="species-grid__loading">
      <span class="species-grid__spinner"></span>
      <p>Caricamento...</p>
    </div>
  } @else if (loadError()) {
    <!-- Error state -->
    <div class="species-grid__loading">
      <p>{{ loadError() }}</p>
      <button class="species-grid__retry" type="button" (click)="retry()">Riprova</button>
    </div>
  } @else {
    <!-- Categories grid -->
    <div class="species-grid__cards">
      @for (category of filteredCategories; track trackByCategory($index, category)) {
        <button
          class="species-grid__card"
          [class.species-grid__card--selected]="selectedCategory() === category.id"
          [class.species-grid__card--small-label]="category.name.length > 7"
          [style.background-image]="'url(' + category.image + ')'"
          (click)="selectCategory(category)"
          [attr.aria-label]="'Esplora ' + category.name">
          <span class="species-grid__card-label">{{ category.name }}</span>
        </button>
      }
    </div>

    @if (filteredCategories.length === 0 && searchQuery) {
      <p class="species-grid__no-results">
        Nessuna specie trovata per "{{ searchQuery }}"
      </p>
    }
  }
</div>
