<app-tab-page-shell-default
  title="Banda Pelosa"
  activeTabId="pet-profile"
  backgroundVariant="tab-menu"
  [showBack]="true"
  (backClicked)="goBack()">

  <!-- Branding extra: subtitle under logo (same style as fatti-bestiali) -->
  <p shellBrandingExtra class="pet-friends-subtitle">
    Qui trovi la tua <strong>banda pelosa</strong><br>
    Gli amici con cui hai gi&agrave; interagito
  </p>

  <!-- Sticky: action buttons -->
  <ng-container shellStickyContent>
    <div class="pet-friends-intro">
      <div class="pet-friends-intro__actions">
        <button
          class="pet-friends-intro__action-btn"
          (click)="onAddFriendClick()"
          aria-label="Aggiungi amico">
          <span class="material-icons">person_add</span>
        </button>
        <button
          class="pet-friends-intro__action-btn"
          aria-label="Messaggi">
          <span class="material-icons">chat_bubble_outline</span>
        </button>
        <button
          class="pet-friends-intro__action-btn"
          aria-label="Notifiche">
          <span class="material-icons">notifications_none</span>
        </button>
      </div>
    </div>
  </ng-container>

  <!-- Empty state -->
  @if (isEmpty()) {
    <div class="pet-friends-empty">
      <div class="pet-friends-empty__icon-wrapper">
        <span class="material-icons pet-friends-empty__icon">group</span>
      </div>
      <h2 class="pet-friends-empty__title">Nessun amico ancora</h2>
      <p class="pet-friends-empty__text">
        Trova nuovi amici pelosi con cui giocare!
      </p>
      <button
        class="pet-friends-empty__btn"
        (click)="onAddFriendClick()">
        <span class="material-icons">person_add</span>
        Trova Amici
      </button>
    </div>
  }

  <!-- Friends list -->
  @if (!isEmpty()) {
    <div class="pet-friends-list">
      @for (friend of friends(); track friend.id) {
        <button
          class="pet-friends-card"
          (click)="onFriendClick(friend)">

          <!-- Avatar with online indicator -->
          <div class="pet-friends-card__avatar-wrapper">
            <img
              [src]="friend.avatarUrl"
              [alt]="friend.name"
              class="pet-friends-card__avatar"
              loading="lazy" />
            @if (friend.online) {
              <span class="pet-friends-card__online-badge"></span>
            }
          </div>

          <!-- Info -->
          <div class="pet-friends-card__info">
            <h3 class="pet-friends-card__name">{{ friend.name }}</h3>
            <p class="pet-friends-card__species">{{ friend.species }}</p>
            <p class="pet-friends-card__owner">
              <span class="material-icons">person</span>
              {{ friend.ownerName }}
            </p>
            <p class="pet-friends-card__since">
              Amici da {{ formatFriendsSince(friend.friendsSince) }}
            </p>
          </div>

          <!-- Status -->
          <div class="pet-friends-card__status">
            @if (friend.online) {
              <span class="pet-friends-card__status-badge pet-friends-card__status-badge--online">
                Online
              </span>
            } @else {
              <span class="pet-friends-card__status-badge">
                Offline
              </span>
            }
          </div>
        </button>
      }
    </div>
  }

</app-tab-page-shell-default>
