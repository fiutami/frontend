<div class="chat-list">
  <!-- Header -->
  <header class="chat-list__header">
    <button
      class="chat-list__back-btn"
      (click)="goBack()"
      aria-label="Torna indietro"
    >
      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
      </svg>
    </button>

    <h1 class="chat-list__title">Messaggi</h1>

    <button
      class="chat-list__menu-btn"
      (click)="openDrawer()"
      aria-label="Apri menu"
    >
      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
      </svg>
    </button>
  </header>

  <!-- Conversations List -->
  <main class="chat-list__content">
    @if (conversations.length === 0) {
      <!-- Empty state - will be shown if no conversations -->
      <div class="chat-list__empty">
        <svg class="chat-list__empty-icon" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke-width="2"/>
        </svg>
        <p class="chat-list__empty-text">Nessuna conversazione</p>
        <p class="chat-list__empty-hint">Inizia a chattare con gli amici dei tuoi pet!</p>
      </div>
    } @else {
      <ul class="chat-list__list">
        @for (conversation of conversations; track conversation.id) {
          <li class="chat-list__item" (click)="openConversation(conversation.id)">
            <div class="chat-list__avatar">
              @if (conversation.avatar) {
                <img
                  [src]="conversation.avatar"
                  [alt]="conversation.name"
                  class="chat-list__avatar-img"
                />
              } @else {
                <div class="chat-list__avatar-placeholder">
                  {{ getAvatarPlaceholder(conversation.name) }}
                </div>
              }
            </div>

            <div class="chat-list__info">
              <div class="chat-list__top-row">
                <span class="chat-list__name">{{ conversation.name }}</span>
                <span class="chat-list__time">{{ conversation.time }}</span>
              </div>
              <div class="chat-list__bottom-row">
                <p class="chat-list__message">{{ conversation.lastMessage }}</p>
                @if (conversation.unread > 0) {
                  <span class="chat-list__badge">{{ conversation.unread }}</span>
                }
              </div>
            </div>
          </li>
        }
      </ul>
    }
  </main>

  <!-- Bottom Tab Bar -->
  <app-bottom-tab-bar [tabs]="tabs" [activeTabId]="'chat'"></app-bottom-tab-bar>
</div>
