<div class="home">
  <!-- Background Image with Overlay -->
  <app-page-background
    imageName="auth-bg"
    overlayOpacity="light">
  </app-page-background>

  <!-- Header -->
  <header class="home__header">
    <!-- Avatar (links to pet profile) -->
    <button
      class="home__avatar"
      routerLink="/home/pet-profile"
      aria-label="Vai al profilo del pet"
    >
      @if (showInitials()) {
        <div class="home__avatar-initials" [attr.aria-label]="petName() + ' avatar'">
          {{ initials() }}
        </div>
      } @else {
        <img
          [src]="avatarUrl()"
          [alt]="petName() + ' avatar'"
          class="home__avatar-img"
          loading="lazy"
        />
      }
    </button>

    <div class="home__header-actions">
      <!-- Notifications/Calendar bell -->
      <button
        class="home__icon-btn"
        (click)="navigateToCalendar()"
        aria-label="Calendario e notifiche"
      >
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/>
        </svg>
        @if (notificationCount > 0) {
          <span class="home__badge">{{ notificationCount }}</span>
        }
      </button>

      <!-- Hamburger menu -->
      <button
        class="home__icon-btn"
        (click)="openDrawer()"
        aria-label="Apri menu"
      >
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
        </svg>
      </button>
    </div>
  </header>

  <!-- Main content -->
  <main class="home__content">
    <!-- Search bar -->
    <div class="home__search-wrapper">
      <app-search-box
        placeholder="Cosa posso fiutare per te?"
        variant="glass"
        [value]="searchQuery"
        (search)="onSearch($event)">
      </app-search-box>
    </div>

    <!-- Upcoming events widget -->
    <div class="home__events-wrapper">
      <app-events-widget
        title="Prossimi eventi"
        [events]="upcomingEvents"
        emptyMessage="Non c'Ã¨ nessun evento in programma."
        (eventClick)="onEventClick($event)"
        (viewAllClick)="onViewAllEvents()">
      </app-events-widget>
    </div>
  </main>

  <!-- Bottom Tab Bar (Blue) -->
  <app-bottom-tab-bar [tabs]="tabs" [activeTabId]="'home'"></app-bottom-tab-bar>
</div>
