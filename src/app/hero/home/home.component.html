<div class="home">
  <!-- Background Image with Overlay -->
  <app-page-background
    imageName="auth-bg"
    overlayOpacity="light">
  </app-page-background>

  <!-- Header -->
  <header class="home__header">
    <!-- Spacer per bilanciare il layout -->
    <div class="home__header-spacer"></div>

    <div class="home__header-actions">
      <!-- Menu avatar (apre drawer con profilo e impostazioni) -->
      <app-avatar-button size="large" mode="pet" class="home__avatar-btn"></app-avatar-button>
    </div>
  </header>

  <!-- Main content -->
  <main class="home__content">
    <!-- Greeting Section -->
    <section class="home__greeting">
      <h1 class="home__greeting-title">
        Ciao {{ userName() }}!
      </h1>
      @if (isPathA() && petName()) {
        <p class="home__greeting-subtitle">Come sta {{ petName() }} oggi?</p>
      } @else if (isPathB()) {
        <p class="home__greeting-subtitle">Pronto a trovare il tuo compagno?</p>
      }
    </section>

    <!-- Search bar + Notification Bell -->
    <div class="home__search-row">
      <app-search-box
        class="home__search"
        placeholder="Cosa posso fiutare per te?"
        variant="glass"
        [value]="searchQuery"
        (search)="onSearch($event)">
      </app-search-box>

      <app-notification-bell [count]="unreadNotifications()"></app-notification-bell>
    </div>
  </main>

  <!-- Fiuto Mascot Peek (draggable from right edge) -->
  <app-mascot-peek
    #mascotPeek
    [hidden]="showMascotSheet()"
    (mascotTapped)="onMascotClick()">
  </app-mascot-peek>

  <!-- Mascot Bottom Sheet (AI Mode) -->
  <app-mascot-bottom-sheet
    [isOpen]="showMascotSheet()"
    [hideMascot]="true"
    [suggestions]="mascotSuggestions()"
    [aiMessage]="'Ciao! Ecco cosa ho trovato per te oggi...'"
    (closed)="closeMascotSheet()"
    (suggestionAction)="onMascotSuggestionClick($event)"
    (aiModeChange)="onAiModeChange($event)"
    (chatMessage)="onChatMessage($event)">
  </app-mascot-bottom-sheet>

  <!-- Bottom Tab Bar (Blue) - hidden in AI Mode -->
  <app-bottom-tab-bar [tabs]="tabs" [activeTabId]="'home'" [hidden]="isAiModeActive()"></app-bottom-tab-bar>
</div>
