<!-- Usa TabPageShellDefault: Avatar, Logo, MascotPeek, TabBar sono automatici -->
<app-tab-page-shell-default
  title="Calendario"
  activeTabId="calendar"
  [showBack]="true"
  (backClicked)="onBack()">

  <!-- Extra sotto il logo (dentro blu): Data odierna -->
  <app-calendar-date-display shellBrandingExtra [date]="currentDate()" />

  <!-- Sticky Content (su giallo): Quick Actions + Chips + Testo -->
  <ng-container shellStickyContent>
    <!-- Quick Actions Row (3 icons: notifications, calendar, bookmark) -->
    <app-quick-actions-row
      class="quick-actions--on-yellow"
      [items]="quickActionItems"
      [activeId]="overlayService.activeFilter()"
      (selected)="onFilterIconClick($event)" />

    <!-- Action Chips Row (3 pills) -->
    <app-action-chips-row
      [chips]="actionChips"
      (chipClicked)="onActionButtonClick($event)" />

    <!-- Descriptive Text -->
    <p class="calendar-description">In che mese andiamo a mettere il naso?</p>
  </ng-container>

  <!-- Main Content: Year Nav + Month Grid -->
  <!-- Year Navigation -->
  <div class="calendar-year-nav">
    <button class="calendar-year-nav__btn" (click)="prevYear()" aria-label="Anno precedente">
      <span class="material-icons">chevron_left</span>
    </button>
    <span class="calendar-year-nav__year">{{ selectedYear() }}</span>
    <button class="calendar-year-nav__btn" (click)="nextYear()" aria-label="Anno successivo">
      <span class="material-icons">chevron_right</span>
    </button>
  </div>

  <!-- Month Grid -->
  <div class="calendar-grid">
    <div class="calendar-grid__column">
      @for (month of leftColumnMonths; track month.index) {
        <button
          class="calendar-month-btn"
          [class.calendar-month-btn--current]="isCurrentMonth(month.index)"
          (click)="selectMonth(month.index)">
          {{ month.name }}
        </button>
      }
    </div>
    <div class="calendar-grid__column">
      @for (month of rightColumnMonths; track month.index) {
        <button
          class="calendar-month-btn"
          [class.calendar-month-btn--current]="isCurrentMonth(month.index)"
          (click)="selectMonth(month.index)">
          {{ month.name }}
        </button>
      }
    </div>
  </div>

  <!-- Overlays -->
  @if (overlayService.isOpen()) {
    @switch (overlayService.overlayType()) {
      @case ('saved') { <app-calendar-saved-overlay /> }
      @case ('month') { <app-calendar-month-overlay /> }
      @case ('notifications') { <app-calendar-notifications-overlay /> }
      @case ('create-event') { <app-calendar-create-event-overlay /> }
      @case ('events-list') { <app-calendar-events-overlay /> }
      @case ('birthdays') { <app-calendar-birthdays-overlay /> }
    }
  }

</app-tab-page-shell-default>
