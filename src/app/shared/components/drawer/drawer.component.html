<!-- Backdrop overlay -->
<div
  class="drawer-backdrop"
  [@fadeInOut]="isOpen ? 'open' : 'closed'"
  (click)="onBackdropClick()"
  aria-hidden="true"
></div>

<!-- Drawer panel -->
<aside
  class="drawer"
  [@slideInOut]="isOpen ? 'open' : 'closed'"
  role="dialog"
  aria-modal="true"
  aria-label="Menu di navigazione"
  [attr.data-viewport]="viewportSize()"
  data-testid="drawer-container"
>
  <!-- Header -->
  <header class="drawer__header">
    <!-- Back button -->
    <button
      class="drawer__back"
      (click)="close()"
      aria-label="Chiudi menu"
      type="button"
    >
      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
      </svg>
    </button>

    <!-- Avatar -->
    <button
      class="drawer__avatar"
      (click)="navigateToProfile()"
      aria-label="Vai al profilo"
      type="button"
    >
      <img
        src="assets/images/default-pet-avatar.png"
        alt="Avatar pet"
        class="drawer__avatar-img"
        loading="lazy"
      />
    </button>
  </header>

  <!-- Title -->
  <div class="drawer__title-section">
    <h2 class="drawer__title">FiutaMi</h2>
    <p class="drawer__subtitle">Impostazioni e attivit√†</p>
  </div>

  <!-- Search bar -->
  <div class="drawer__search">
    <svg class="drawer__search-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
      <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
    </svg>
    <input
      type="text"
      class="drawer__search-input"
      placeholder="Cerca..."
      [value]="searchQuery"
      (input)="onSearchChange($event)"
      aria-label="Cerca nel menu"
    />
  </div>

  <!-- Menu items -->
  <nav class="drawer__nav" aria-label="Menu principale">
    <ul class="drawer__menu">
      @for (item of filteredMenuItems; track item.label) {
        @if (item.separator) {
          <li class="drawer__separator" role="separator"></li>
        } @else {
          <li class="drawer__menu-item">
            <button
              class="drawer__menu-button"
              (click)="onMenuItemClick(item)"
              type="button"
            >
              <span class="drawer__menu-label">{{ item.label }}</span>
              <svg class="drawer__menu-arrow" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
              </svg>
            </button>
          </li>
        }
      }
    </ul>
  </nav>
</aside>
