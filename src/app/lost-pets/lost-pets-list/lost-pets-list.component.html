<div class="lost-pets-container">
  <!-- Header -->
  <header class="lost-header">
    <button class="back-btn" (click)="goBack()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
    <h1>{{ 'lostPets.title' | translate }}</h1>
    <button class="report-btn" (click)="reportLost()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
  </header>

  <!-- Hero Section -->
  <div class="hero-section">
    <p class="hero-subtitle">{{ 'lostPets.heroSubtitle' | translate }}</p>
  </div>

  <!-- Quick Actions -->
  <div class="quick-actions">
    <button class="action-card" (click)="openEmergencyContacts()">
      <span class="icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M22 16.92V19.92C22 20.48 21.56 20.93 21 20.93C10.51 20.93 2 12.42 2 1.93C2 1.37 2.45 0.93 3.01 0.93H6.01C6.56 0.93 7.01 1.36 7.04 1.91C7.07 2.48 7.14 3.04 7.25 3.58C7.29 3.79 7.24 4.01 7.1 4.18L4.86 6.41C6.07 8.57 7.95 10.45 10.11 11.66L12.34 9.43C12.51 9.29 12.73 9.24 12.94 9.28C13.48 9.39 14.04 9.46 14.61 9.49C15.16 9.52 15.59 9.97 15.59 10.52V13.52C15.59 14.08 15.14 14.52 14.59 14.52C14.57 14.52 14.56 14.52 14.54 14.52" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </span>
      <span class="label">{{ 'lostPets.emergencyContacts' | translate }}</span>
    </button>
    <button class="action-card primary" (click)="reportLost()">
      <span class="icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </span>
      <span class="label">{{ 'lostPets.reportLost' | translate }}</span>
    </button>
  </div>

  <!-- Search Bar -->
  <div class="search-bar">
    <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none">
      <path d="M21 21L15 15M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <input type="text" [placeholder]="'lostPets.searchPlaceholder' | translate" />
    <button class="filter-btn">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
        <path d="M22 3H2L10 12.46V19L14 21V12.46L22 3Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button [class.active]="activeTab() === 'nearby'" (click)="setTab('nearby')">
      {{ 'lostPets.nearby' | translate }}
    </button>
    <button [class.active]="activeTab() === 'all'" (click)="setTab('all')">
      {{ 'lostPets.allItaly' | translate }}
    </button>
  </div>

  <!-- Loading -->
  @if (loading()) {
    <div class="loading">
      <div class="spinner"></div>
    </div>
  }

  <!-- Empty State -->
  @if (!loading() && lostPets().length === 0) {
    <div class="empty-state">
      <div class="illustration">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none">
          <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20Z" fill="#E5E7EB"/>
          <path d="M10 9C10 8.44772 10.4477 8 11 8C11.5523 8 12 8.44772 12 9V13C12 13.5523 11.5523 14 11 14C10.4477 14 10 13.5523 10 13V9Z" fill="#9CA3AF"/>
          <path d="M14 9C14 8.44772 14.4477 8 15 8C15.5523 8 16 8.44772 16 9C16 9.55228 15.5523 10 15 10C14.4477 10 14 9.55228 14 9Z" fill="#9CA3AF"/>
          <path d="M8 9C8 8.44772 8.44772 8 9 8C9.55228 8 10 8.44772 10 9C10 9.55228 9.55228 10 9 10C8.44772 10 8 9.55228 8 9Z" fill="#9CA3AF"/>
        </svg>
      </div>
      <h2>{{ 'lostPets.empty.title' | translate }}</h2>
      <p>{{ 'lostPets.empty.subtitle' | translate }}</p>
    </div>
  }

  <!-- Lost Pets List -->
  @if (!loading() && lostPets().length > 0) {
    <div class="lost-list">
      @for (pet of lostPets(); track trackByPet($index, pet)) {
        <div
          class="lost-card"
          [class.urgent]="isRecent(pet)"
          (click)="openDetail(pet)">

          <div class="pet-photo">
            @if (pet.petPhotoUrl) {
              <img [src]="pet.petPhotoUrl" [alt]="pet.petName" />
            } @else {
              <div class="photo-placeholder">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                  <path d="M10.5 14.5C10.5 15.3284 9.82843 16 9 16C8.17157 16 7.5 15.3284 7.5 14.5C7.5 13.6716 8.17157 13 9 13C9.82843 13 10.5 13.6716 10.5 14.5Z" fill="currentColor"/>
                  <path d="M16.5 14.5C16.5 15.3284 15.8284 16 15 16C14.1716 16 13.5 15.3284 13.5 14.5C13.5 13.6716 14.1716 13 15 13C15.8284 13 16.5 13.6716 16.5 14.5Z" fill="currentColor"/>
                  <path d="M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21Z" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
            }
            @if (pet.status === 'found') {
              <span class="status-badge found">{{ 'lostPets.found' | translate }}</span>
            }
          </div>

          <div class="card-content">
            <div class="header-row">
              <h3>{{ pet.petName }}</h3>
              @if (pet.reward) {
                <span class="reward">{{ pet.reward | currency:'EUR':'symbol':'1.0-0' }}</span>
              }
            </div>
            <p class="species">
              {{ pet.petSpecies }}
              @if (pet.petBreed) {
                <span> &bull; {{ pet.petBreed }}</span>
              }
            </p>
            <p class="owner">{{ 'lostPets.owner' | translate }}: {{ pet.ownerName }}</p>
            <p class="location">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                <path d="M21 10C21 17 12 23 12 23C12 23 3 17 3 10C3 7.61305 3.94821 5.32387 5.63604 3.63604C7.32387 1.94821 9.61305 1 12 1C14.3869 1 16.6761 1.94821 18.364 3.63604C20.0518 5.32387 21 7.61305 21 10Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
              </svg>
              {{ pet.lastSeenCity || pet.lastSeenLocation }}
            </p>
            <p class="date">{{ formatDate(pet.lastSeenDate) }}</p>
            @if (pet.sightingsCount > 0) {
              <p class="sightings">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                  <path d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12C23 12 19 20 12 20C5 20 1 12 1 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                </svg>
                {{ pet.sightingsCount }} {{ 'lostPets.sightings' | translate }}
              </p>
            }
          </div>

          <div class="card-actions">
            <button class="info-btn">{{ 'lostPets.info' | translate }}</button>
            <button class="contact-btn" (click)="reportSighting(pet, $event)">{{ 'lostPets.contact' | translate }}</button>
          </div>
        </div>
      }
    </div>

    <!-- View All Link -->
    <div class="view-all-link">
      <a [routerLink]="['/lost-pets']" [queryParams]="{view: 'all'}">
        {{ 'lostPets.viewInYourArea' | translate }}
        <svg width="6" height="11" viewBox="0 0 6 11" fill="none">
          <path d="M1 1L5 5.5L1 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </a>
    </div>
  }
</div>
